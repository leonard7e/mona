{% set tags = [] %}
{% set categories = [] %}
{% for m in page.collection %}
  {% for t in m.taxonomy.tag %}
    {% if t not in tags %}
      {% set tags = tags | merge([t]) %}
    {% endif %}
  {% endfor %}
  {% for c in m.taxonomy.category %}
    {% if c not in categories %}
      {% set categories = categories | merge([c]) %}
    {% endif %}
  {% endfor %}
{% endfor %}
<div class="Taxonomy Switches" >
  <div ng-init="filterInit(0)">
    <h4 ng-click="filterSwitch(0)" ng-class="{Active: filterIsActive(0)}">
      Filtriere Kategorien
       <span class="toExpand"></span>
     </h4>
    <div class="CategoryList">
      {% for c in categories %}
        <span
          class="Category"
          tabindex="0"
          ng-class='
            {
              Active: taxSwitchActive("category",{
                "category": ["{{c}}"],
                "tag": []
              }),
              Hide: taxHideCategorySwitch("{{c}}")
            }'
            ng-click='taxDoSwitch("category","{{c}}")'
            > {{ c }}
        </span>
      {% endfor %}
    </div>
  </div>
  <div ng-init="filterInit(1)">
    <h4 ng-click="filterSwitch(1)" ng-class="{Active: filterIsActive(1)}">
      Filtriere Schlagworte
       <span class="toExpand"></span>
     </h4>
    <div class="TagList">
      {% for t in tags %}
        <span class="Tag"
          tabindex="0"
          ng-class='
            {
              Active: taxSwitchActive("tag",{
                tag: ["{{t}}"],
                category:[]
              }),
              Hide: taxHideTagSwitch("{{t}}")
            }'
          ng-click='taxDoSwitch("tag","{{t}}")'
          >
        {{ t }}
      </span>
      {% endfor %}
    </div>
  </div>
</div>
